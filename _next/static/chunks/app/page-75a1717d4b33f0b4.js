(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4188:function(e,a,l){Promise.resolve().then(l.bind(l,1089))},1089:function(e,a,l){"use strict";l.r(a),l.d(a,{default:function(){return e5}});var s,o,t,n,r=l(1146),i=l(4960),d=l(9674),c=l(4767),m=l(5595),h=l(8364),u=l(7938),x=l(7584),p=l(7752),j=l(4852),N=l(6260),g=l(8279),b=l(370),v=l(5568),y=l(5171),_=l(6675),Z=l(65),f=l(657),C=l(3962),z=l(4324),w=l(5779),I=l(2230),k=l(802),F=l(4550),G=l(7609),T=l(6743),P=l(9091),S=l.n(P);let{Panel:M}=G.default,{Text:L}=T.default,O=[{key:"basic",title:"基础节点",items:[{type:"inputNode",label:"输入节点",icon:(0,r.jsx)(c.Z,{size:18}),color:"#64748b"},{type:"llmNode",label:"LLM 节点",icon:(0,r.jsx)(m.Z,{size:18}),color:"#64748b"},{type:"outputNode",label:"输出节点",icon:(0,r.jsx)(h.Z,{size:18}),color:"#64748b"}]},{key:"source",title:"1. 图像源",items:[{type:"cameraNode",label:"相机采集",icon:(0,r.jsx)(u.Z,{size:18}),color:"#3b82f6"},{type:"imageFileNode",label:"本地图片",icon:(0,r.jsx)(x.Z,{size:18}),color:"#3b82f6"}]},{key:"preprocessing",title:"2. 图像预处理",items:[{type:"colorConvertNode",label:"颜色转换",icon:(0,r.jsx)(p.Z,{size:18}),color:"#10b981"},{type:"filterNode",label:"图像滤波",icon:(0,r.jsx)(j.Z,{size:18}),color:"#10b981"},{type:"thresholdNode",label:"二值化",icon:(0,r.jsx)(N.Z,{size:18}),color:"#10b981"},{type:"cropNode",label:"ROI 裁剪",icon:(0,r.jsx)(g.Z,{size:18}),color:"#10b981"}]},{key:"positioning",title:"3. 定位与对齐",items:[{type:"templateMatchNode",label:"模板匹配",icon:(0,r.jsx)(b.Z,{size:18}),color:"#8b5cf6"},{type:"shapeFinderNode",label:"几何查找",icon:(0,r.jsx)(v.Z,{size:18}),color:"#8b5cf6"}]},{key:"inspection",title:"4. 检测与测量",items:[{type:"blobAnalysisNode",label:"斑点分析",icon:(0,r.jsx)(y.Z,{size:18}),color:"#f59e0b"},{type:"caliperNode",label:"卡尺测量",icon:(0,r.jsx)(_.Z,{size:18}),color:"#f59e0b"},{type:"codeReaderNode",label:"读码",icon:(0,r.jsx)(Z.Z,{size:18}),color:"#f59e0b"},{type:"ocrNode",label:"字符识别",icon:(0,r.jsx)(f.Z,{size:18}),color:"#f59e0b"}]},{key:"deepLearning",title:"5. 深度学习",items:[{type:"aiClassificationNode",label:"AI 分类",icon:(0,r.jsx)(C.Z,{size:18}),color:"#ef4444"},{type:"aiDetectionNode",label:"AI 检测",icon:(0,r.jsx)(z.Z,{size:18}),color:"#ef4444"}]},{key:"logic",title:"6. 逻辑与输出",items:[{type:"logicCheckNode",label:"逻辑判断",icon:(0,r.jsx)(w.Z,{size:18}),color:"#6366f1"},{type:"scriptNode",label:"脚本运算",icon:(0,r.jsx)(I.Z,{size:18}),color:"#6366f1"},{type:"displayNode",label:"图像显示",icon:(0,r.jsx)(k.Z,{size:18}),color:"#6366f1"},{type:"commOutputNode",label:"通讯输出",icon:(0,r.jsx)(F.Z,{size:18}),color:"#6366f1"}]}];function R(){let e=(e,a,l)=>{e.dataTransfer.setData("application/reactflow",JSON.stringify({type:a,label:l})),e.dataTransfer.effectAllowed="move"};return(0,r.jsxs)("div",{className:S().sidebar,children:[(0,r.jsxs)("div",{className:S().header,children:[(0,r.jsx)("h3",{children:"组件库"}),(0,r.jsx)("p",{children:"拖拽节点到画布"})]}),(0,r.jsx)("div",{className:S().nodeList,children:(0,r.jsx)(G.default,{defaultActiveKey:["basic","source"],ghost:!0,expandIconPosition:"end",className:S().collapse,children:O.map(a=>(0,r.jsx)(M,{header:(0,r.jsx)("span",{className:S().categoryTitle,children:a.title}),children:(0,r.jsx)("div",{className:S().categoryContent,children:a.items.map(a=>(0,r.jsxs)("div",{className:S().nodeItem,draggable:!0,onDragStart:l=>e(l,a.type,a.label),style:{borderLeft:"3px solid ".concat(a.color)},children:[(0,r.jsx)("span",{className:S().nodeIcon,style:{color:a.color,borderColor:a.color,background:"".concat(a.color,"10")},children:a.icon}),(0,r.jsx)("span",{className:S().nodeLabel,children:a.label})]},a.type))})},a.key))})})]})}var A=l(4070);l(1841);var D=l(4859),E=l(3682),H=l(2621);let W=(e,a)=>({nodes:[],onNodesChange:a=>{e(e=>{e.nodes=(0,i.Fb)(a,e.nodes)})},addNode:a=>{e(e=>{e.nodes.push(a)})},updateNodeData:(a,l)=>{e(e=>{let s=e.nodes.find(e=>e.id===a);s&&(s.data={...s.data,...l})})},setNodes:a=>{e(e=>{e.nodes=a})},deleteSelectedNodes:()=>{e(e=>{e.nodes=e.nodes.filter(e=>!e.selected)})}});var B=l(9285);let V=(e,a)=>({edges:[],onEdgesChange:a=>{e(e=>{e.edges=(0,i.yn)(a,e.edges)})},onConnect:a=>{e(e=>{e.edges=(0,B.Z_)({...a,animated:!0},e.edges)})},setEdges:a=>{e(e=>{e.edges=a})},deleteSelectedEdges:()=>{e(e=>{e.edges=e.edges.filter(e=>!e.selected)})}}),q=(e,a)=>({workflows:[],saveWorkflow:(a,l,s,o)=>{let t={id:"wf_".concat(Date.now()),name:a,nodes:l,edges:s,viewport:o,createdAt:Date.now()};e(e=>{e.workflows.unshift(t)})},loadWorkflow:l=>{let s=a().workflows.find(e=>e.id===l);return s&&e(e=>{e.nodes=s.nodes,e.edges=s.edges}),s},deleteWorkflow:a=>{e(e=>{e.workflows=e.workflows.filter(e=>e.id!==a)})}}),U=(0,D.Ue)()((0,H.mW)((0,E.n)((e,a,l)=>({...W(e,a,l),...V(e,a,l),...q(e,a,l),selectedNodeId:null,setSelectedNodeId:a=>{e(e=>{e.selectedNodeId=a})}}))));var K=l(1780),X=l(6556),Q=l(4491),Y=l.n(Q),J=(0,A.memo)(function(e){let{id:a,data:l,selected:s}=e,o=U(e=>e.updateNodeData);return(0,r.jsxs)("div",{className:(0,X.Z)(Y().node,{[Y().selected]:s}),children:[(0,r.jsx)(i.HH,{type:"source",position:B.Ly.Right,id:"output"}),(0,r.jsxs)("div",{className:Y().header,children:[(0,r.jsx)("span",{className:Y().icon,children:(0,r.jsx)(c.Z,{size:16})}),(0,r.jsx)("span",{className:Y().title,children:"输入"})]}),(0,r.jsxs)("div",{className:Y().body,children:[(0,r.jsx)("div",{className:Y().label,children:l.label}),(0,r.jsx)(K.default,{className:"nodrag",value:l.value,onChange:e=>o(a,{value:e.target.value}),placeholder:"输入值",size:"small"})]})]})}),$=l(1269),ee=l(4089),ea=l(6845),el=l.n(ea);let{TextArea:es}=K.default;var eo=(0,A.memo)(function(e){let{id:a,data:l,selected:s}=e,o=U(e=>e.updateNodeData);return(0,r.jsxs)("div",{className:(0,X.Z)(el().node,{[el().selected]:s}),children:[(0,r.jsx)(i.HH,{type:"target",position:B.Ly.Left,id:"input"}),(0,r.jsxs)("div",{className:el().header,children:[(0,r.jsx)("span",{className:el().icon,children:(0,r.jsx)(m.Z,{size:16})}),(0,r.jsx)("span",{className:el().title,children:"LLM"})]}),(0,r.jsxs)("div",{className:el().body,children:[(0,r.jsxs)("div",{className:el().section,children:[(0,r.jsx)("label",{className:el().label,children:"模型"}),(0,r.jsx)($.Z,{className:"nodrag",value:l.model,onChange:e=>o(a,{model:e}),options:[{value:"gpt-4.1-mini",label:"GPT-4.1 Mini"},{value:"gpt-4",label:"GPT-4"},{value:"gemini-2.5-flash",label:"Gemini 2.5 Flash"},{value:"claude-3.5-sonnet",label:"Claude 3.5 Sonnet"}],size:"small"})]}),(0,r.jsxs)("div",{className:el().section,children:[(0,r.jsxs)("label",{className:el().label,children:["温度: ",l.temperature.toFixed(1)]}),(0,r.jsx)(ee.Z,{className:"nodrag",min:0,max:2,step:.1,value:l.temperature,onChange:e=>o(a,{temperature:e})})]}),(0,r.jsxs)("div",{className:el().section,children:[(0,r.jsx)("label",{className:el().label,children:"系统提示词"}),(0,r.jsx)(es,{className:"nodrag",value:l.systemPrompt,onChange:e=>o(a,{systemPrompt:e.target.value}),placeholder:"输入系统提示词...",rows:2,size:"small"})]})]}),(0,r.jsx)(i.HH,{type:"source",position:B.Ly.Right,id:"output"})]})}),et=l(5556),en=l.n(et),er=(0,A.memo)(function(e){let{data:a,selected:l}=e;return(0,r.jsxs)("div",{className:(0,X.Z)(en().node,{[en().selected]:l}),children:[(0,r.jsx)(i.HH,{type:"target",position:B.Ly.Left,id:"input"}),(0,r.jsxs)("div",{className:en().header,children:[(0,r.jsx)("span",{className:en().icon,children:(0,r.jsx)(h.Z,{size:16})}),(0,r.jsx)("span",{className:en().title,children:"输出"})]}),(0,r.jsxs)("div",{className:en().body,children:[(0,r.jsx)("div",{className:en().label,children:a.label}),a.output&&(0,r.jsxs)("div",{className:en().outputArea,children:[(0,r.jsx)("div",{className:en().label,children:"输出结果:"}),a.output]})]})]})}),ei=l(2728),ed=l(3374),ec=l(1073),em=l.n(ec);let eh={cameraNode:u.Z,imageFileNode:x.Z,colorConvertNode:p.Z,filterNode:j.Z,thresholdNode:N.Z,cropNode:g.Z,templateMatchNode:b.Z,shapeFinderNode:v.Z,blobAnalysisNode:y.Z,caliperNode:_.Z,codeReaderNode:Z.Z,ocrNode:f.Z,aiClassificationNode:C.Z,aiDetectionNode:z.Z,logicCheckNode:w.Z,scriptNode:I.Z,displayNode:k.Z,commOutputNode:F.Z},eu={cameraNode:"#3b82f6",imageFileNode:"#3b82f6",colorConvertNode:"#10b981",filterNode:"#10b981",thresholdNode:"#10b981",cropNode:"#10b981",templateMatchNode:"#8b5cf6",shapeFinderNode:"#8b5cf6",blobAnalysisNode:"#f59e0b",caliperNode:"#f59e0b",codeReaderNode:"#f59e0b",ocrNode:"#f59e0b",aiClassificationNode:"#ef4444",aiDetectionNode:"#ef4444",logicCheckNode:"#6366f1",scriptNode:"#6366f1",displayNode:"#6366f1",commOutputNode:"#6366f1"},ex=(e,a,l)=>{switch(e){case"cameraNode":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"相机 ID"}),(0,r.jsx)($.Z,{className:"nodrag",size:"small",value:a.cameraId,onChange:e=>l({cameraId:e}),options:[{value:"cam_0",label:"默认相机"},{value:"cam_1",label:"工业相机 1"},{value:"cam_2",label:"工业相机 2"}]})]}),(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsxs)("label",{children:["曝光 (μs): ",a.exposureTime]}),(0,r.jsx)(ee.Z,{className:"nodrag",min:100,max:2e4,step:100,value:a.exposureTime,onChange:e=>l({exposureTime:e}),style:{width:"90%"}})]}),(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsxs)("label",{children:["增益 (dB): ",a.gain]}),(0,r.jsx)(ee.Z,{className:"nodrag",min:0,max:24,step:.1,value:a.gain,onChange:e=>l({gain:e}),style:{width:"90%"}})]}),(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"触发模式"}),(0,r.jsx)($.Z,{className:"nodrag",size:"small",value:a.triggerMode,onChange:e=>l({triggerMode:e}),options:[{value:"software",label:"软触发"},{value:"hardware",label:"硬触发"},{value:"continuous",label:"连续"}]})]}),(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"超时 (ms)"}),(0,r.jsx)(ei.Z,{className:"nodrag",size:"small",value:a.timeout,onChange:e=>l({timeout:e}),style:{width:"100%"}})]})]});case"imageFileNode":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"文件路径"}),(0,r.jsx)(K.default,{className:"nodrag",size:"small",value:a.filePath,onChange:e=>l({filePath:e.target.value}),placeholder:"/path/to/image"})]}),(0,r.jsxs)("div",{className:em().controlGroup,style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between"},children:[(0,r.jsx)("label",{children:"循环读取"}),(0,r.jsx)(ed.Z,{className:"nodrag",size:"small",checked:a.loop,onChange:e=>l({loop:e})})]})]});case"colorConvertNode":return(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"模式"}),(0,r.jsx)($.Z,{className:"nodrag",size:"small",value:a.mode,onChange:e=>l({mode:e}),options:[{value:"rgb2gray",label:"RGB 转 灰度"},{value:"rgb2hsv",label:"RGB 转 HSV"},{value:"bgr2rgb",label:"BGR 转 RGB"}]})]});case"filterNode":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"类型"}),(0,r.jsx)($.Z,{className:"nodrag",size:"small",value:a.filterType,onChange:e=>l({filterType:e}),options:[{value:"gaussian",label:"高斯滤波"},{value:"median",label:"中值滤波"},{value:"blur",label:"均值滤波"}]})]}),(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"核大小"}),(0,r.jsx)(ei.Z,{className:"nodrag",size:"small",min:3,max:15,step:2,value:a.kernelSize,onChange:e=>l({kernelSize:e}),style:{width:"100%"}})]}),"gaussian"===a.filterType&&(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"Sigma"}),(0,r.jsx)(ei.Z,{className:"nodrag",size:"small",step:.1,value:a.sigma,onChange:e=>l({sigma:e}),style:{width:"100%"}})]})]});case"thresholdNode":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"方法"}),(0,r.jsx)($.Z,{className:"nodrag",size:"small",value:a.method,onChange:e=>l({method:e}),options:[{value:"binary",label:"固定阈值"},{value:"otsu",label:"OTSU"},{value:"adaptive",label:"自适应"}]})]}),(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsxs)("label",{children:["阈值: ",a.threshold]}),(0,r.jsx)(ee.Z,{className:"nodrag",min:0,max:255,value:a.threshold,onChange:e=>l({threshold:e}),disabled:"binary"!==a.method,style:{width:"90%"}})]}),(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"最大值"}),(0,r.jsx)(ei.Z,{className:"nodrag",size:"small",value:a.maxValue,onChange:e=>l({maxValue:e}),style:{width:"100%"}})]}),(0,r.jsxs)("div",{className:em().controlGroup,style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between"},children:[(0,r.jsx)("label",{children:"反转"}),(0,r.jsx)(ed.Z,{className:"nodrag",size:"small",checked:a.inverse,onChange:e=>l({inverse:e})})]})]});case"cropNode":return(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"X 坐标"}),(0,r.jsx)(ei.Z,{className:"nodrag",size:"small",value:a.x,onChange:e=>l({x:e}),style:{width:"100%"}})]}),(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"Y 坐标"}),(0,r.jsx)(ei.Z,{className:"nodrag",size:"small",value:a.y,onChange:e=>l({y:e}),style:{width:"100%"}})]}),(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"宽度 (W)"}),(0,r.jsx)(ei.Z,{className:"nodrag",size:"small",value:a.width,onChange:e=>l({width:e}),style:{width:"100%"}})]}),(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"高度 (H)"}),(0,r.jsx)(ei.Z,{className:"nodrag",size:"small",value:a.height,onChange:e=>l({height:e}),style:{width:"100%"}})]})]});case"templateMatchNode":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"模板路径"}),(0,r.jsx)(K.default,{className:"nodrag",size:"small",value:a.templatePath,onChange:e=>l({templatePath:e.target.value})})]}),(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsxs)("label",{children:["最小分数: ",a.minScore]}),(0,r.jsx)(ee.Z,{className:"nodrag",min:0,max:1,step:.01,value:a.minScore,onChange:e=>l({minScore:e}),style:{width:"90%"}})]}),(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"最大匹配数"}),(0,r.jsx)(ei.Z,{className:"nodrag",size:"small",value:a.maxMatches,onChange:e=>l({maxMatches:e}),style:{width:"100%"}})]}),(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"角度范围 +/-"}),(0,r.jsx)(ei.Z,{className:"nodrag",size:"small",value:a.angleRange,onChange:e=>l({angleRange:e}),style:{width:"100%"}})]})]});case"shapeFinderNode":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"形状"}),(0,r.jsx)($.Z,{className:"nodrag",size:"small",value:a.shapeType,onChange:e=>l({shapeType:e}),options:[{value:"circle",label:"圆形"},{value:"rectangle",label:"矩形"},{value:"line",label:"直线"}]})]}),(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"最小尺寸 (Min)"}),(0,r.jsx)(ei.Z,{className:"nodrag",size:"small",value:a.minSize,onChange:e=>l({minSize:e}),style:{width:"100%"}})]}),(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"最大尺寸 (Max)"}),(0,r.jsx)(ei.Z,{className:"nodrag",size:"small",value:a.maxSize,onChange:e=>l({maxSize:e}),style:{width:"100%"}})]}),(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsxs)("label",{children:["边缘阈值: ",a.edgeThreshold]}),(0,r.jsx)(ee.Z,{className:"nodrag",min:1,max:100,value:a.edgeThreshold,onChange:e=>l({edgeThreshold:e}),style:{width:"90%"}})]})]});case"blobAnalysisNode":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"目标颜色"}),(0,r.jsx)($.Z,{className:"nodrag",size:"small",value:a.colorMode,onChange:e=>l({colorMode:e}),options:[{value:"white",label:"白斑"},{value:"black",label:"黑斑"}]})]}),(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"最小面积"}),(0,r.jsx)(ei.Z,{className:"nodrag",size:"small",value:a.minArea,onChange:e=>l({minArea:e}),style:{width:"100%"}})]}),(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"最大面积"}),(0,r.jsx)(ei.Z,{className:"nodrag",size:"small",value:a.maxArea,onChange:e=>l({maxArea:e}),style:{width:"100%"}})]}),(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsxs)("label",{children:["圆度: ",a.circularity]}),(0,r.jsx)(ee.Z,{className:"nodrag",min:0,max:1,step:.1,value:a.circularity,onChange:e=>l({circularity:e}),style:{width:"90%"}})]}),(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsxs)("label",{children:["凸度: ",a.convexity]}),(0,r.jsx)(ee.Z,{className:"nodrag",min:0,max:1,step:.1,value:a.convexity,onChange:e=>l({convexity:e}),style:{width:"90%"}})]})]});case"caliperNode":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"方向"}),(0,r.jsx)($.Z,{className:"nodrag",size:"small",value:a.direction,onChange:e=>l({direction:e}),options:[{value:"horizontal",label:"水平"},{value:"vertical",label:"垂直"},{value:"radial",label:"径向"}]})]}),(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"极性"}),(0,r.jsx)($.Z,{className:"nodrag",size:"small",value:a.polarity,onChange:e=>l({polarity:e}),options:[{value:"dark_to_light",label:"黑到白"},{value:"light_to_dark",label:"白到黑"},{value:"any",label:"任意"}]})]}),(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"投影宽度"}),(0,r.jsx)(ei.Z,{className:"nodrag",size:"small",value:a.projectionWidth,onChange:e=>l({projectionWidth:e}),style:{width:"100%"}})]}),(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsxs)("label",{children:["边缘阈值: ",a.edgeThreshold]}),(0,r.jsx)(ee.Z,{className:"nodrag",min:1,max:100,value:a.edgeThreshold,onChange:e=>l({edgeThreshold:e}),style:{width:"90%"}})]})]});case"codeReaderNode":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"码制"}),(0,r.jsx)($.Z,{className:"nodrag",size:"small",mode:"multiple",value:a.codeType,onChange:e=>l({codeType:e}),options:[{value:"qr",label:"QR"},{value:"dm",label:"DM"},{value:"bar",label:"Bar"}],maxTagCount:1})]}),(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"超时 (ms)"}),(0,r.jsx)(ei.Z,{className:"nodrag",size:"small",step:100,value:a.timeout,onChange:e=>l({timeout:e}),style:{width:"100%"}})]})]});case"ocrNode":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"字符高"}),(0,r.jsx)(ei.Z,{className:"nodrag",size:"small",value:a.charHeight,onChange:e=>l({charHeight:e}),style:{width:"100%"}})]}),(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsxs)("label",{children:["置信度: ",a.minScore]}),(0,r.jsx)(ee.Z,{className:"nodrag",min:0,max:1,step:.1,value:a.minScore,onChange:e=>l({minScore:e}),style:{width:"90%"}})]}),(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"正则过滤"}),(0,r.jsx)(K.default,{className:"nodrag",size:"small",value:a.pattern,onChange:e=>l({pattern:e.target.value}),placeholder:"如 [A-Z]{3}"})]})]});case"aiClassificationNode":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"模型路径"}),(0,r.jsx)(K.default,{className:"nodrag",size:"small",value:a.modelPath,onChange:e=>l({modelPath:e.target.value})})]}),(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsxs)("label",{children:["置信度: ",a.confidence]}),(0,r.jsx)(ee.Z,{className:"nodrag",min:0,max:1,step:.05,value:a.confidence,onChange:e=>l({confidence:e}),style:{width:"90%"}})]})]});case"aiDetectionNode":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"模型路径"}),(0,r.jsx)(K.default,{className:"nodrag",size:"small",value:a.modelPath,onChange:e=>l({modelPath:e.target.value})})]}),(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsxs)("label",{children:["置信度: ",a.confidence]}),(0,r.jsx)(ee.Z,{className:"nodrag",min:0,max:1,step:.05,value:a.confidence,onChange:e=>l({confidence:e}),style:{width:"90%"}})]}),(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"IOU 阈值"}),(0,r.jsx)(ei.Z,{className:"nodrag",size:"small",step:.05,min:0,max:1,value:a.iouThreshold,onChange:e=>l({iouThreshold:e}),style:{width:"100%"}})]}),(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"最大数量"}),(0,r.jsx)(ei.Z,{className:"nodrag",size:"small",value:a.maxObjects,onChange:e=>l({maxObjects:e}),style:{width:"100%"}})]})]});case"logicCheckNode":return(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"比较"}),(0,r.jsxs)("div",{style:{display:"flex",gap:4},children:[(0,r.jsx)($.Z,{className:"nodrag",size:"small",style:{width:80},value:a.operator,onChange:e=>l({operator:e}),options:[{value:"eq",label:"=="},{value:"gt",label:">"},{value:"lt",label:"<"}]}),(0,r.jsx)(K.default,{className:"nodrag",size:"small",style:{flex:1},value:a.reference,onChange:e=>l({reference:e.target.value}),placeholder:"值"})]})]});case"commOutputNode":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"协议"}),(0,r.jsx)($.Z,{className:"nodrag",size:"small",value:a.protocol,onChange:e=>l({protocol:e}),options:[{value:"tcp_client",label:"TCP Client"},{value:"tcp_server",label:"TCP Server"},{value:"modbus_tcp",label:"Modbus TCP"}]})]}),(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"IP 地址"}),(0,r.jsx)(K.default,{className:"nodrag",size:"small",value:a.ip,onChange:e=>l({ip:e.target.value})})]}),(0,r.jsxs)("div",{className:em().controlGroup,children:[(0,r.jsx)("label",{children:"端口"}),(0,r.jsx)(ei.Z,{className:"nodrag",size:"small",value:a.port,onChange:e=>l({port:e}),style:{width:"100%"}})]})]});case"displayNode":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:em().controlGroup,style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between"},children:[(0,r.jsx)("label",{children:"显示叠加层"}),(0,r.jsx)(ed.Z,{className:"nodrag",size:"small",checked:a.showOverlay,onChange:e=>l({showOverlay:e})})]}),(0,r.jsxs)("div",{className:em().controlGroup,style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between"},children:[(0,r.jsx)("label",{children:"自适应窗口"}),(0,r.jsx)(ed.Z,{className:"nodrag",size:"small",checked:a.autoFit,onChange:e=>l({autoFit:e})})]})]});default:if("scriptNode"===e)return(0,r.jsx)("div",{className:em().param,children:"请在右侧面板编辑脚本"});return null}};var ep=(0,A.memo)(function(e){let{id:a,data:l,type:s,selected:o}=e,{updateNodeData:t}=U(),n=eh[s||""]||u.Z,d=eu[s||""]||"#64748b";return(0,r.jsxs)("div",{className:(0,X.Z)(em().node,{[em().selected]:o}),children:[(0,r.jsx)(i.HH,{type:"target",position:B.Ly.Left,id:"input"}),(0,r.jsxs)("div",{className:em().header,style:{borderBottomColor:"".concat(d,"40")},children:[(0,r.jsx)("span",{className:em().icon,style:{color:d,background:"".concat(d,"15"),borderColor:"".concat(d,"40")},children:(0,r.jsx)(n,{size:14})}),(0,r.jsx)("span",{className:em().title,children:l.label})]}),(0,r.jsxs)("div",{className:em().body,children:[ex(s||"",l,e=>{t(a,e)}),l.status&&(0,r.jsxs)("div",{className:em().status,children:["状态: ",(0,r.jsx)("span",{className:(0,X.Z)(em().statusTag,em()[l.status]),children:l.status})]}),l.error&&(0,r.jsx)("div",{className:em().error,children:l.error})]}),(0,r.jsx)(i.HH,{type:"source",position:B.Ly.Right,id:"output"})]})});let ej={inputNode:J,llmNode:eo,outputNode:er,cameraNode:ep,imageFileNode:ep,colorConvertNode:ep,filterNode:ep,thresholdNode:ep,cropNode:ep,templateMatchNode:ep,shapeFinderNode:ep,blobAnalysisNode:ep,caliperNode:ep,codeReaderNode:ep,ocrNode:ep,aiClassificationNode:ep,aiDetectionNode:ep,logicCheckNode:ep,scriptNode:ep,displayNode:ep,commOutputNode:ep};var eN=l(3322),eg=l.n(eN);let eb=e=>({nodes:e.nodes,edges:e.edges,onNodesChange:e.onNodesChange,onEdgesChange:e.onEdgesChange,onConnect:e.onConnect,addNode:e.addNode,setSelectedNodeId:e.setSelectedNodeId});function ev(){let{nodes:e,edges:a,onNodesChange:l,onEdgesChange:s,onConnect:o,addNode:t,setSelectedNodeId:n}=U(eb),d=(0,A.useRef)(null),{screenToFlowPosition:c}=(0,i._K)(),m=(0,A.useCallback)(e=>e.source!==e.target&&!!e.source&&!!e.target,[]),h=(0,A.useCallback)(e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"},[]),u=(0,A.useCallback)(e=>{e.preventDefault();let a=e.dataTransfer.getData("application/reactflow");if(!a)return;let{type:l,label:s}=JSON.parse(a),o=c({x:e.clientX,y:e.clientY}),n={label:s};switch(l){case"llmNode":n.model="gpt-4.1-mini",n.temperature=.7;break;case"inputNode":n.value="";break;case"cameraNode":n.cameraId="cam_0",n.exposureTime=5e3,n.gain=0,n.triggerMode="software",n.timeout=2e3;break;case"imageFileNode":n.filePath="",n.loop=!0,n.interval=1e3;break;case"colorConvertNode":n.mode="rgb2gray";break;case"filterNode":n.filterType="gaussian",n.kernelSize=3,n.sigma=1;break;case"thresholdNode":n.method="binary",n.threshold=128,n.maxValue=255,n.inverse=!1;break;case"cropNode":n.x=0,n.y=0,n.width=100,n.height=100,n.interactive=!0;break;case"templateMatchNode":n.templatePath="",n.method="ncc",n.minScore=.8,n.maxMatches=1,n.angleRange=0;break;case"shapeFinderNode":n.shapeType="circle",n.minSize=10,n.maxSize=100,n.edgeThreshold=20;break;case"blobAnalysisNode":n.colorMode="white",n.minArea=10,n.maxArea=1e4,n.circularity=0,n.convexity=0;break;case"caliperNode":n.direction="horizontal",n.edgeMode="strongest",n.polarity="any",n.edgeThreshold=20,n.projectionWidth=5;break;case"codeReaderNode":n.codeType=["qr","dm"],n.timeout=1e3,n.multiple=!1;break;case"ocrNode":n.fontLibrary="standard",n.charHeight=30,n.charWidth=20,n.minScore=.6,n.pattern="";break;case"aiClassificationNode":n.modelPath="",n.confidence=.5,n.device="cpu";break;case"aiDetectionNode":n.modelPath="",n.confidence=.5,n.iouThreshold=.45,n.maxObjects=100,n.device="cpu";break;case"logicCheckNode":n.inputType="number",n.operator="eq",n.reference="";break;case"scriptNode":n.language="javascript",n.script="return input;";break;case"displayNode":n.showOverlay=!0,n.overlayColor="#00FF00",n.autoFit=!0;break;case"commOutputNode":n.protocol="tcp_client",n.ip="127.0.0.1",n.port=502,n.format="json"}t({id:"node_".concat(Date.now()),type:l,position:o,data:n})},[c,t]),x=(0,A.useCallback)((e,a)=>{n(a.id)},[n]),p=(0,A.useCallback)(()=>{n(null)},[n]);return(0,r.jsx)("div",{ref:d,className:eg().canvasWrapper,children:(0,r.jsxs)(i.x$,{nodes:e,edges:a,onNodesChange:l,onEdgesChange:s,onConnect:o,isValidConnection:m,onDragOver:h,onDrop:u,onNodeClick:x,onPaneClick:p,nodeTypes:ej,defaultEdgeOptions:{type:"smoothstep",animated:!0,style:{strokeWidth:2}},fitView:!0,className:eg().reactFlow,children:[(0,r.jsx)(i.Aq,{gap:16,size:1,color:"#27272a"}),(0,r.jsx)(i.ZX,{}),(0,r.jsx)(i.a9,{nodeStrokeColor:e=>e.selected?"#6366f1":"#27272a",nodeColor:e=>"inputNode"===e.type||"llmNode"===e.type||"outputNode"===e.type?"#64748b":["cameraNode","imageFileNode"].includes(e.type||"")?"#3b82f6":["colorConvertNode","filterNode","thresholdNode","cropNode"].includes(e.type||"")?"#10b981":["templateMatchNode","shapeFinderNode"].includes(e.type||"")?"#8b5cf6":["blobAnalysisNode","caliperNode","codeReaderNode","ocrNode"].includes(e.type||"")?"#f59e0b":["aiClassificationNode","aiDetectionNode"].includes(e.type||"")?"#ef4444":["logicCheckNode","scriptNode","displayNode","commOutputNode"].includes(e.type||"")?"#6366f1":"#18181b"})]})})}var ey=l(9431),e_=l(8695),eZ=l(467),ef=l(789),eC=l(2228),ez=l(9782),ew=l(7290),eI=l(1989),ek=l(7913),eF=l(4256),eG=l(6314),eT=l(730),eP=l(4668),eS=l(5829),eM=l(5785),eL=l(1508);let eO=new(l.n(eL)()),eR={"elk.algorithm":"layered","elk.direction":"RIGHT","elk.spacing.nodeNode":"100","layered.spacing.nodeNodeBetweenLayers":"100","elk.padding":"[top=50, left=50, bottom=50, right=50]","elk.edgeRouting":"ORTHOGONAL","elk.layered.nodePlacement.strategy":"BRANDES_KOEPF"},eA=e=>{if(e.measured&&e.measured.width&&e.measured.height)return{width:e.measured.width,height:e.measured.height};switch(e.type){case"llmNode":return{width:300,height:360};case"inputNode":return{width:260,height:180};case"outputNode":return{width:260,height:240};default:return{width:200,height:100}}},eD=async function(e,a){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s={id:"root",layoutOptions:{...eR,...l},children:e.map(e=>{let{width:a,height:l}=eA(e);return{...e,width:a,height:l}}),edges:a.map(e=>({...e,sources:[e.source],targets:[e.target]}))};try{let a=await eO.layout(s);return e.map(e=>{var l,s,o;let t=null===(l=a.children)||void 0===l?void 0:l.find(a=>a.id===e.id);return t?{...e,position:{x:null!==(s=t.x)&&void 0!==s?s:e.position.x,y:null!==(o=t.y)&&void 0!==o?o:e.position.y}}:e})}catch(a){return e}};(s=t||(t={})).Idle="idle",s.Running="running",s.Success="success",s.Failed="failed",(o=n||(n={})).Input="inputNode",o.LLM="llmNode",o.Output="outputNode",o.Camera="cameraNode",o.ImageFile="imageFileNode",o.ColorConvert="colorConvertNode",o.Filter="filterNode",o.Threshold="thresholdNode",o.Crop="cropNode",o.TemplateMatch="templateMatchNode",o.ShapeFinder="shapeFinderNode",o.BlobAnalysis="blobAnalysisNode",o.Caliper="caliperNode",o.CodeReader="codeReaderNode",o.OCR="ocrNode",o.AIClassification="aiClassificationNode",o.AIDetection="aiDetectionNode",o.LogicCheck="logicCheckNode",o.Script="scriptNode",o.Display="displayNode",o.CommOutput="commOutputNode";let eE=e=>new Promise(a=>setTimeout(a,e)),eH=async(e,a,l)=>(await eE(1500),"[".concat(e,'] 生成的回复:\n基于输入 "').concat(a,'" (temp: ').concat(l,")\n这是一个模拟的 AI 回复内容。")),eW=async(e,a)=>{await eE(800);let l=new Date().toLocaleTimeString();switch(e){case"cameraNode":return"[".concat(l,"] 采集图像: IMG_").concat(Math.floor(1e3*Math.random()),".jpg (2448x2048)");case"imageFileNode":return"[".concat(l,"] 加载本地图像: test_sample_01.png");case"colorConvertNode":return"".concat(a," -> [灰度化处理完成]");case"filterNode":return"".concat(a," -> [高斯滤波完成]");case"thresholdNode":return"".concat(a," -> [二值化分割完成]");case"cropNode":return"".concat(a," -> [ROI裁剪完成: (100,100, 500x500)]");case"templateMatchNode":let s=(.8+.2*Math.random()).toFixed(3);return"".concat(a," -> [模板匹配成功: Score=").concat(s,", Pos=(1234, 567)]");case"shapeFinderNode":return"".concat(a," -> [找到圆形: R=45.2, Center=(1234, 567)]");case"blobAnalysisNode":return"".concat(a," -> [斑点分析: 发现 ").concat(Math.floor(5*Math.random())+1," 个缺陷点]");case"caliperNode":let o=(10+Math.random()).toFixed(3);return"".concat(a," -> [卡尺测量: 宽度=").concat(o,"mm]");case"codeReaderNode":return"".concat(a," -> [读码成功: SN1234567890]");case"ocrNode":return"".concat(a,' -> [OCR识别: "LOT-2023-A"]');case"aiClassificationNode":let t=(.9+.1*Math.random()).toFixed(2);return"".concat(a,' -> [AI分类: "OK" (置信度: ').concat(t,")]");case"aiDetectionNode":return"".concat(a,' -> [AI检测: 发现 "Scratch" @ (100,200)]');case"logicCheckNode":return"".concat(a," -> [逻辑判断: PASS]");case"scriptNode":return"".concat(a," -> [脚本执行完毕]");case"commOutputNode":return"".concat(a," -> [数据已发送至 PLC: Done]");default:return a}},eB=async(e,a,l)=>{e.forEach(e=>{l(e.id,{status:t.Idle,error:void 0}),("outputNode"===e.type||"displayNode"===e.type)&&l(e.id,{output:""})});let s={},o={},n=new Map(e.map(e=>[e.id,e]));e.forEach(e=>{s[e.id]=[],o[e.id]=0}),a.forEach(e=>{s[e.source]&&s[e.source].push(e.target),o[e.target]=(o[e.target]||0)+1});let r=e.filter(e=>0===o[e.id]).map(e=>e.id),i={};for(;r.length>0;){let e=r.shift(),d=n.get(e);if(d)try{l(e,{status:t.Running});let n=a.filter(a=>a.target===e).map(e=>i[e.source]).filter(e=>void 0!==e),c=n.length>0?n[n.length-1]:"",m="";if("inputNode"===d.type)m=String(d.data.value||"");else if("llmNode"===d.type){if(!c&&!d.data.systemPrompt)throw Error("LLM 节点需要输入或系统提示词");let e="".concat(d.data.systemPrompt||"","\n").concat(c);m=await eH(d.data.model||"gpt-4",e,d.data.temperature||.7)}else"outputNode"===d.type?(m=c,l(e,{output:m})):(m=await eW(d.type||"",c),"displayNode"===d.type&&l(e,{output:m}));for(let a of(i[e]=m,l(e,{status:t.Success}),s[e]||[]))o[a]--,0===o[a]&&r.push(a)}catch(a){l(e,{status:t.Failed,error:a.message||"执行出错"});return}}};var eV=l(7953),eq=l.n(eV);let{Text:eU}=T.default;function eK(){let{nodes:e,edges:a,setNodes:l,setEdges:s,deleteSelectedNodes:o,workflows:t,saveWorkflow:n,loadWorkflow:d,deleteWorkflow:c}=U(),{getViewport:m,setViewport:h}=(0,i._K)(),[u,x]=(0,A.useState)(!1),[p,j]=(0,A.useState)(!1),[N,g]=(0,A.useState)(""),b=async()=>{l(await eD(e,a)),ey.ZP.success("布局已自动整理")},v=()=>{if(!N.trim()){ey.ZP.warning("请输入配置名称");return}n(N,e,a,m()),ey.ZP.success("配置已保存"),x(!1)},y=e=>{let a=d(e);a&&(h(a.viewport),ey.ZP.success("已加载配置: ".concat(a.name)),j(!1))},_=(e,a)=>{a.stopPropagation(),c(e),ey.ZP.success("配置已删除")},Z=async()=>{ey.ZP.loading({content:"工作流运行中...",key:"run_workflow"});try{await eB(e,a,U.getState().updateNodeData),ey.ZP.success({content:"运行完成",key:"run_workflow"})}catch(e){ey.ZP.error({content:"运行出错",key:"run_workflow"})}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:eq().toolbar,children:[(0,r.jsx)(eZ.ZP,{type:"primary",icon:(0,r.jsx)(eI.Z,{size:16}),onClick:Z,children:"运行"}),(0,r.jsx)("div",{style:{width:1,height:24,background:"var(--border-color)",margin:"0 4px"}}),(0,r.jsx)(ef.Z,{title:"新建空白画布",children:(0,r.jsx)(eZ.ZP,{icon:(0,r.jsx)(ek.Z,{size:16}),onClick:()=>{e_.Z.confirm({title:"确认新建",content:"这将清空当前画布，未保存的内容将会丢失。确定要继续吗？",okText:"确定",cancelText:"取消",onOk:()=>{l([]),s([]),ey.ZP.success("已新建空白工作流")}})},children:"新建"})}),(0,r.jsx)(ef.Z,{title:"保存当前配置",children:(0,r.jsx)(eZ.ZP,{icon:(0,r.jsx)(eF.Z,{size:16}),onClick:()=>{g("工作流 ".concat(new Date().toLocaleString())),x(!0)},children:"保存"})}),(0,r.jsx)(ef.Z,{title:"查看已保存的配置",children:(0,r.jsxs)(eZ.ZP,{icon:(0,r.jsx)(eG.Z,{size:16}),onClick:()=>j(!0),children:["历史记录",(0,r.jsx)("span",{style:{marginLeft:6,background:"var(--bg-panel)",padding:"0 6px",borderRadius:10,fontSize:11},children:t.length})]})}),(0,r.jsx)("div",{style:{width:1,height:24,background:"var(--border-color)",margin:"0 4px"}}),(0,r.jsx)(ef.Z,{title:"自动整理布局",children:(0,r.jsx)(eZ.ZP,{icon:(0,r.jsx)(eT.Z,{size:16}),onClick:b,children:"自动布局"})}),(0,r.jsx)(ef.Z,{title:"删除选中元素",children:(0,r.jsx)(eZ.ZP,{icon:(0,r.jsx)(eP.Z,{size:16}),danger:!0,onClick:()=>{o(),s(a.filter(e=>!e.selected))},children:"删除"})})]}),(0,r.jsxs)(e_.Z,{title:"保存当前配置",open:u,onOk:v,onCancel:()=>x(!1),okText:"保存",cancelText:"取消",children:[(0,r.jsx)("div",{style:{marginBottom:16},children:(0,r.jsx)(eU,{type:"secondary",children:"配置将保存在当前会话中，刷新页面后会丢失。"})}),(0,r.jsx)(K.default,{placeholder:"请输入配置名称",value:N,onChange:e=>g(e.target.value),onPressEnter:v,autoFocus:!0})]}),(0,r.jsx)(eC.Z,{title:"已保存的配置",placement:"right",onClose:()=>j(!1),open:p,width:320,children:0===t.length?(0,r.jsx)(ez.Z,{description:"暂无保存的配置",image:ez.Z.PRESENTED_IMAGE_SIMPLE}):(0,r.jsx)(ew.Z,{itemLayout:"horizontal",dataSource:t,renderItem:e=>(0,r.jsx)(ew.Z.Item,{className:eq().historyItem,actions:[(0,r.jsx)(eZ.ZP,{type:"text",size:"small",icon:(0,r.jsx)(eS.Z,{size:14}),onClick:()=>y(e.id),title:"加载此配置"},"load"),(0,r.jsx)(eZ.ZP,{type:"text",danger:!0,size:"small",icon:(0,r.jsx)(eM.Z,{size:14}),onClick:a=>_(e.id,a),title:"删除此配置"},"delete")],children:(0,r.jsx)(ew.Z.Item.Meta,{title:(0,r.jsx)("span",{style:{cursor:"pointer",color:"var(--text-primary)"},onClick:()=>y(e.id),children:e.name}),description:(0,r.jsxs)("span",{style:{fontSize:12},children:[e.createdAt?new Date(e.createdAt).toLocaleTimeString():"-"," \xb7 ",e.nodes.length," 个节点"]})})})})})]})}var eX=l(8514),eQ=l(1817),eY=l(7707),eJ=l.n(eY);let{Title:e$,Text:e0}=T.default,{TextArea:e1}=K.default;function e2(){let{nodes:e,selectedNodeId:a,updateNodeData:l}=U(),[s]=eX.Z.useForm(),o=e.find(e=>e.id===a);return(o&&s.setFieldsValue(o.data),o)?(0,r.jsxs)("div",{className:eJ().panel,children:[(0,r.jsx)("div",{className:eJ().header,children:(0,r.jsx)(e$,{level:5,className:eJ().title,children:"节点属性"})}),(0,r.jsx)(eQ.Z,{style:{margin:"12px 0"}}),(0,r.jsxs)(eX.Z,{form:s,layout:"vertical",onValuesChange:(e,s)=>{a&&l(a,s)},initialValues:o.data,className:eJ().form,children:[(0,r.jsx)(eX.Z.Item,{name:"label",label:"节点名称",children:(0,r.jsx)(K.default,{size:"small"})}),(0,r.jsx)(eQ.Z,{style:{margin:"12px 0"}}),(()=>{switch(o.type){case"inputNode":return(0,r.jsx)(eX.Z.Item,{name:"value",label:"输入值",children:(0,r.jsx)(K.default,{size:"small"})});case"llmNode":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eX.Z.Item,{name:"model",label:"模型",children:(0,r.jsx)($.Z,{size:"small",options:[{value:"gpt-4.1-mini",label:"GPT-4.1 Mini"},{value:"gpt-4",label:"GPT-4"},{value:"gemini-2.5-flash",label:"Gemini 2.5 Flash"},{value:"claude-3.5-sonnet",label:"Claude 3.5 Sonnet"}]})}),(0,r.jsx)(eX.Z.Item,{name:"temperature",label:"温度",children:(0,r.jsx)(ee.Z,{min:0,max:2,step:.1})}),(0,r.jsx)(eX.Z.Item,{name:"systemPrompt",label:"系统提示词",children:(0,r.jsx)(e1,{rows:4,size:"small"})})]});case"cameraNode":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eX.Z.Item,{name:"cameraId",label:"相机 ID",children:(0,r.jsx)($.Z,{size:"small",options:[{value:"cam_0",label:"默认相机 (Webcam)"},{value:"cam_1",label:"工业相机 1 (Hikvision)"},{value:"cam_2",label:"工业相机 2 (Basler)"}]})}),(0,r.jsx)(eX.Z.Item,{name:"exposure",label:"曝光时间 (us)",children:(0,r.jsx)(ee.Z,{min:100,max:2e4,step:100})}),(0,r.jsx)(eX.Z.Item,{name:"gain",label:"增益 (dB)",children:(0,r.jsx)(ee.Z,{min:0,max:24,step:.1})}),(0,r.jsx)(eX.Z.Item,{name:"triggerMode",label:"触发模式",children:(0,r.jsx)($.Z,{size:"small",options:[{value:"software",label:"软触发"},{value:"hardware",label:"硬触发"},{value:"continuous",label:"连续采集"}]})})]});case"imageFileNode":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eX.Z.Item,{name:"filePath",label:"文件路径",children:(0,r.jsx)(K.default,{size:"small",placeholder:"/path/to/image.png"})}),(0,r.jsx)(eX.Z.Item,{name:"loop",label:"循环模式",valuePropName:"checked",children:(0,r.jsx)(ed.Z,{size:"small"})})]});case"colorConvertNode":return(0,r.jsx)(eX.Z.Item,{name:"mode",label:"转换模式",children:(0,r.jsx)($.Z,{size:"small",options:[{value:"rgb2gray",label:"RGB 转 灰度"},{value:"rgb2hsv",label:"RGB 转 HSV"},{value:"bgr2rgb",label:"BGR 转 RGB"}]})});case"filterNode":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eX.Z.Item,{name:"filterType",label:"滤波类型",children:(0,r.jsx)($.Z,{size:"small",options:[{value:"gaussian",label:"高斯滤波"},{value:"median",label:"中值滤波"},{value:"blur",label:"均值滤波"}]})}),(0,r.jsx)(eX.Z.Item,{name:"kernelSize",label:"核大小",children:(0,r.jsx)(ei.Z,{size:"small",min:3,max:15,step:2,style:{width:"100%"}})})]});case"thresholdNode":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eX.Z.Item,{name:"method",label:"阈值方法",children:(0,r.jsx)($.Z,{size:"small",options:[{value:"binary",label:"固定阈值"},{value:"otsu",label:"OTSU (自动)"},{value:"adaptive",label:"自适应"}]})}),(0,r.jsx)(eX.Z.Item,{name:"threshold",label:"阈值",children:(0,r.jsx)(ee.Z,{min:0,max:255})}),(0,r.jsx)(eX.Z.Item,{name:"inverse",label:"反转",valuePropName:"checked",children:(0,r.jsx)(ed.Z,{size:"small"})})]});case"cropNode":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eX.Z.Item,{name:"x",label:"X 坐标",children:(0,r.jsx)(ei.Z,{size:"small",style:{width:"100%"}})}),(0,r.jsx)(eX.Z.Item,{name:"y",label:"Y 坐标",children:(0,r.jsx)(ei.Z,{size:"small",style:{width:"100%"}})}),(0,r.jsx)(eX.Z.Item,{name:"width",label:"宽度",children:(0,r.jsx)(ei.Z,{size:"small",style:{width:"100%"}})}),(0,r.jsx)(eX.Z.Item,{name:"height",label:"高度",children:(0,r.jsx)(ei.Z,{size:"small",style:{width:"100%"}})})]});case"templateMatchNode":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eX.Z.Item,{name:"templatePath",label:"模板路径",children:(0,r.jsx)(K.default,{size:"small"})}),(0,r.jsx)(eX.Z.Item,{name:"minScore",label:"最小匹配分数",children:(0,r.jsx)(ee.Z,{min:0,max:1,step:.01})}),(0,r.jsx)(eX.Z.Item,{name:"maxMatches",label:"最大匹配数",children:(0,r.jsx)(ei.Z,{size:"small",min:1,max:10,style:{width:"100%"}})})]});case"shapeFinderNode":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eX.Z.Item,{name:"shapeType",label:"形状类型",children:(0,r.jsx)($.Z,{size:"small",options:[{value:"circle",label:"圆形"},{value:"rectangle",label:"矩形"},{value:"line",label:"直线"}]})}),(0,r.jsx)(eX.Z.Item,{name:"minSize",label:"最小尺寸",children:(0,r.jsx)(ei.Z,{size:"small",style:{width:"100%"}})}),(0,r.jsx)(eX.Z.Item,{name:"maxSize",label:"最大尺寸",children:(0,r.jsx)(ei.Z,{size:"small",style:{width:"100%"}})})]});case"blobAnalysisNode":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eX.Z.Item,{name:"colorMode",label:"目标颜色",children:(0,r.jsx)($.Z,{size:"small",options:[{value:"white",label:"白斑"},{value:"black",label:"黑斑"}]})}),(0,r.jsx)(eX.Z.Item,{name:"minArea",label:"最小面积",children:(0,r.jsx)(ei.Z,{size:"small",style:{width:"100%"}})}),(0,r.jsx)(eX.Z.Item,{name:"circularity",label:"圆度筛选",children:(0,r.jsx)(ee.Z,{min:0,max:1,step:.1})})]});case"caliperNode":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eX.Z.Item,{name:"direction",label:"扫描方向",children:(0,r.jsx)($.Z,{size:"small",options:[{value:"horizontal",label:"水平"},{value:"vertical",label:"垂直"}]})}),(0,r.jsx)(eX.Z.Item,{name:"edgeThreshold",label:"边缘阈值",children:(0,r.jsx)(ee.Z,{min:1,max:100})}),(0,r.jsx)(eX.Z.Item,{name:"polarity",label:"极性",children:(0,r.jsx)($.Z,{size:"small",options:[{value:"dark_to_light",label:"黑到白"},{value:"light_to_dark",label:"白到黑"},{value:"any",label:"任意"}]})})]});case"codeReaderNode":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eX.Z.Item,{name:"codeType",label:"码制类型",children:(0,r.jsx)($.Z,{size:"small",mode:"multiple",options:[{value:"qr",label:"QR Code"},{value:"dm",label:"DataMatrix"},{value:"bar",label:"Barcode (1D)"}]})}),(0,r.jsx)(eX.Z.Item,{name:"timeout",label:"超时时间 (ms)",children:(0,r.jsx)(ei.Z,{size:"small",step:100,style:{width:"100%"}})})]});case"ocrNode":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eX.Z.Item,{name:"fontLibrary",label:"字体库",children:(0,r.jsx)($.Z,{size:"small",options:[{value:"standard",label:"标准字体"},{value:"dot_matrix",label:"点阵字体"}]})}),(0,r.jsx)(eX.Z.Item,{name:"charHeight",label:"字符高度",children:(0,r.jsx)(ei.Z,{size:"small",style:{width:"100%"}})})]});case"aiClassificationNode":case"aiDetectionNode":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eX.Z.Item,{name:"modelPath",label:"模型路径",children:(0,r.jsx)(K.default,{size:"small"})}),(0,r.jsx)(eX.Z.Item,{name:"confidence",label:"置信度阈值",children:(0,r.jsx)(ee.Z,{min:0,max:1,step:.05})}),"aiDetectionNode"===o.type&&(0,r.jsx)(eX.Z.Item,{name:"iou",label:"IOU 阈值",children:(0,r.jsx)(ee.Z,{min:0,max:1,step:.05})}),(0,r.jsx)(eX.Z.Item,{name:"device",label:"推理设备",children:(0,r.jsx)($.Z,{size:"small",options:[{value:"cpu",label:"CPU"},{value:"cuda",label:"GPU (CUDA)"}]})})]});case"logicCheckNode":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eX.Z.Item,{name:"operator",label:"比较操作符",children:(0,r.jsx)($.Z,{size:"small",options:[{value:"eq",label:"等于 (==)"},{value:"gt",label:"大于 (>)"},{value:"lt",label:"小于 (<)"},{value:"contains",label:"包含"}]})}),(0,r.jsx)(eX.Z.Item,{name:"reference",label:"参考值",children:(0,r.jsx)(K.default,{size:"small"})})]});case"scriptNode":return(0,r.jsx)(eX.Z.Item,{name:"script",label:"脚本代码",children:(0,r.jsx)(e1,{rows:8,size:"small",style:{fontFamily:"monospace"},placeholder:"return input + 1;"})});case"commOutputNode":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eX.Z.Item,{name:"protocol",label:"通讯协议",children:(0,r.jsx)($.Z,{size:"small",options:[{value:"tcp_client",label:"TCP Client"},{value:"tcp_server",label:"TCP Server"},{value:"modbus_rtu",label:"Modbus RTU"},{value:"modbus_tcp",label:"Modbus TCP"}]})}),(0,r.jsx)(eX.Z.Item,{name:"ip",label:"IP 地址",children:(0,r.jsx)(K.default,{size:"small",placeholder:"192.168.1.100"})}),(0,r.jsx)(eX.Z.Item,{name:"port",label:"端口",children:(0,r.jsx)(ei.Z,{size:"small",style:{width:"100%"}})})]});case"displayNode":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eX.Z.Item,{name:"showOverlay",label:"显示叠加层",valuePropName:"checked",children:(0,r.jsx)(ed.Z,{size:"small"})}),(0,r.jsx)(eX.Z.Item,{name:"autoFit",label:"自动适应窗口",valuePropName:"checked",children:(0,r.jsx)(ed.Z,{size:"small"})})]});default:return(0,r.jsx)(e0,{type:"secondary",children:"该节点暂无配置项"})}})()]})]}):(0,r.jsx)("div",{className:eJ().panel,children:(0,r.jsx)("div",{className:eJ().empty,children:(0,r.jsx)(e0,{type:"secondary",children:"选择一个节点查看属性"})})})}var e6=l(5193),e4=l.n(e6);function e5(){return(0,r.jsx)(i.tV,{children:(0,r.jsxs)("div",{className:e4().container,children:[(0,r.jsx)("header",{className:e4().header,children:(0,r.jsx)("div",{className:e4().headerContent,children:(0,r.jsxs)("div",{className:e4().logo,children:[(0,r.jsx)("div",{className:e4().logoIconWrapper,children:(0,r.jsx)(d.Z,{className:e4().logoIcon,strokeWidth:2.5})}),(0,r.jsxs)("span",{className:e4().logoText,children:["Flow ",(0,r.jsx)("span",{className:e4().logoHighlight,children:"Node"})]})]})})}),(0,r.jsxs)("main",{className:e4().main,children:[(0,r.jsx)("aside",{className:e4().sidebar,children:(0,r.jsx)(R,{})}),(0,r.jsxs)("section",{className:e4().canvas,children:[(0,r.jsx)(eK,{}),(0,r.jsx)(ev,{})]}),(0,r.jsx)("aside",{className:e4().inspector,children:(0,r.jsx)(e2,{})})]})]})})}},5193:function(e){e.exports={container:"page_container__5KI2x",header:"page_header__8kWA1",headerContent:"page_headerContent__hUyIz",logo:"page_logo__L0rYW",logoIconWrapper:"page_logoIconWrapper__mjYjq",logoIcon:"page_logoIcon__F9ZvX",logoText:"page_logoText__2fWc_",logoHighlight:"page_logoHighlight__mdSwk",main:"page_main__ux7yf",sidebar:"page_sidebar__1pA5r",canvas:"page_canvas__peR88",inspector:"page_inspector__r_RQ6"}},3322:function(e){e.exports={canvasWrapper:"CanvasView_canvasWrapper__7GKen",reactFlow:"CanvasView_reactFlow__QUMuf"}},7953:function(e){e.exports={toolbar:"Toolbar_toolbar__5kvn5",historyItem:"Toolbar_historyItem__Nln6d"}},9091:function(e){e.exports={sidebar:"Sidebar_sidebar__9qnxx",header:"Sidebar_header__wIXeR",nodeList:"Sidebar_nodeList__uQTGQ",collapse:"Sidebar_collapse__xRCv1",categoryContent:"Sidebar_categoryContent__0VyfN",nodeItem:"Sidebar_nodeItem__BAR5m",nodeIcon:"Sidebar_nodeIcon__Vnkcy",nodeLabel:"Sidebar_nodeLabel__1g_jh"}},1073:function(e){e.exports={node:"CommonNode_node__hZ9EG",selected:"CommonNode_selected__IohkO",header:"CommonNode_header__kWtPy",icon:"CommonNode_icon__kza0b",title:"CommonNode_title__Z4RLK",body:"CommonNode_body__pn4iE",controlGroup:"CommonNode_controlGroup__EUmcq",status:"CommonNode_status__q_q_x",statusTag:"CommonNode_statusTag__eHWHj",idle:"CommonNode_idle__xwbe4",running:"CommonNode_running__i1_fY",success:"CommonNode_success__Ba3sy",failed:"CommonNode_failed__E8Rh6",error:"CommonNode_error__2DfgR"}},4491:function(e){e.exports={node:"InputNode_node__yroxc",selected:"InputNode_selected__3A5zd",header:"InputNode_header__hiHp7",icon:"InputNode_icon__p8sMX",title:"InputNode_title__FWLgs",body:"InputNode_body__w6_mV",label:"InputNode_label__gKKwP"}},6845:function(e){e.exports={node:"LLMNode_node__XJ6WL",selected:"LLMNode_selected__4Xtnd",header:"LLMNode_header__51TwV",icon:"LLMNode_icon__jwOvd",title:"LLMNode_title__V9ftu",body:"LLMNode_body__2RjBM",section:"LLMNode_section__DaL9z",label:"LLMNode_label__zLnI2"}},5556:function(e){e.exports={node:"OutputNode_node__hGr92",selected:"OutputNode_selected__zeGV1",header:"OutputNode_header__kx_EQ",icon:"OutputNode_icon__GxD7C",title:"OutputNode_title__b773u",body:"OutputNode_body__AoTP_",label:"OutputNode_label__DFnUb",outputArea:"OutputNode_outputArea__xvoEq"}},7707:function(e){e.exports={panel:"InspectorPanel_panel__20muF",header:"InspectorPanel_header__GFI4a",title:"InspectorPanel_title__IM_CR",form:"InspectorPanel_form__duF1F",empty:"InspectorPanel_empty__6uVGO"}}},function(e){e.O(0,[639,623,96,636,270,518,744],function(){return e(e.s=4188)}),_N_E=e.O()}]);